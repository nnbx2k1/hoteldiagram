<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Mermaid Diagram</title>
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    <style>
      body {
        background: #f5f5f5;
        font-family: sans-serif;
        padding: 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .mermaid {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        max-width: 800px;
      }
    </style>
  </head>
  <body>
    <h1>Activity Diagram</h1>
    <div class="mermaid">
      flowchart TD
    Start([🏠 User Visits App]) --> Search{Search Method?}
    
    %% Search Branch
    Search -->|By Name| SearchName[🔍 Search Établissement by Name]
    Search -->|By Location| SearchLoc[📍 Select Location/City]
    
    %% Search Results
    SearchName --> ShowHotel[🏨 Display Specific Établissement]
    SearchLoc --> ShowList[📋 Display List of Établissements]
    ShowList --> SelectHotel[✅ Select Établissement]
    SelectHotel --> ShowHotel
    
    %% Hotel Browsing
    ShowHotel --> ViewDetails[ℹ️ View Hotel Details & Services]
    ViewDetails --> ViewCategories[🛏️ Browse Room Categories]
    ViewCategories --> SelectCategory[✅ Select Room Category]
    SelectCategory --> ViewRoom[🎥 View Room Details & Media]
    
    %% Availability Check
    ViewRoom --> CheckAvail{Check Availability}
    CheckAvail -->|Available| SelectTime[⏰ Select Date & Time]
    CheckAvail -->|Not Available| ViewCategories
    
    %% Reservation Process
    SelectTime --> CreateReserv[📝 Create Temporary Reservation]
    CreateReserv --> Payment[💳 Initiate E-Payment]
    
    %% Payment Branch
    Payment --> PaymentGW[🏦 Process Payment via Gateway]
    PaymentGW --> PaymentResult{Payment Status?}
    
    %% Payment Results
    PaymentResult -->|Success| ConfirmReserv[✅ Confirm Reservation in DB]
    PaymentResult -->|Failed| PaymentFailed[❌ Payment Failed]
    PaymentResult -->|Timeout| PaymentTimeout[⏱️ Payment Timeout]
    
    %% Success Flow
    ConfirmReserv --> SendConfirm[📧 Send Confirmation Email/SMS]
    SendConfirm --> ShowSuccess[🎉 Display Success Page]
    ShowSuccess --> DownloadReceipt[📄 Download Receipt]
    DownloadReceipt --> End([End])
    
    %% Failure Flows
    PaymentFailed --> RetryPayment{Retry Payment?}
    PaymentTimeout --> RetryPayment
    RetryPayment -->|Yes| Payment
    RetryPayment -->|No| CancelReserv[❌ Cancel Temporary Reservation]
    CancelReserv --> End
    
    %% Back Navigation Options
    ViewRoom -.->|Back| ViewCategories
    ViewCategories -.->|Back| ViewDetails
    ViewDetails -.->|Back| ShowHotel
    SelectTime -.->|Back| ViewRoom
    
    %% Styling
    classDef startEnd fill:#4caf50,stroke:#2e7d32,stroke-width:2px,color:#fff
    classDef process fill:#2196f3,stroke:#1565c0,stroke-width:2px,color:#fff
    classDef decision fill:#ff9800,stroke:#ef6c00,stroke-width:2px,color:#fff
    classDef error fill:#f44336,stroke:#c62828,stroke-width:2px,color:#fff
    classDef success fill:#8bc34a,stroke:#558b2f,stroke-width:2px,color:#fff
    
    class Start,End startEnd
    class SearchName,SearchLoc,ShowHotel,ShowList,SelectHotel,ViewDetails,ViewCategories,SelectCategory,ViewRoom,SelectTime,CreateReserv,Payment,PaymentGW,ConfirmReserv,SendConfirm,DownloadReceipt process
    class Search,CheckAvail,PaymentResult,RetryPayment decision
    class PaymentFailed,PaymentTimeout,CancelReserv error
    class ShowSuccess success
    </div>
  </body>
</html>
